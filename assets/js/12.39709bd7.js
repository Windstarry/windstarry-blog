(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{533:function(s,t,a){s.exports=a.p+"assets/img/Snipaste_2022-03-09_11-35-43.6605a274.png"},534:function(s,t,a){s.exports=a.p+"assets/img/Snipaste_2022-03-09_11-42-07.375fce2c.png"},535:function(s,t,a){s.exports=a.p+"assets/img/Snipaste_2022-03-09_11-43-07.f122acc0.png"},536:function(s,t,a){s.exports=a.p+"assets/img/Snipaste_2022-03-09_11-44-34.3f1f8af8.png"},561:function(s,t,a){"use strict";a.r(t);var n=a(29),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("使用 GitHub Actions CI 将博客部署到 GitHub。")]),s._v(" "),n("p",[s._v("网上有很多文章，但是我仍要重新写一遍。")]),s._v(" "),n("blockquote",[n("p",[s._v("这东西别迷信什么权威，正所谓猫有猫道，狗有狗道，每个人的习惯不一样，做法也不一样，但最后的效果都差不多。别看谁和谁说的不一样，就认为一定有一个错的。")])]),s._v(" "),n("h2",{attrs:{id:"生成-ssh-密钥对"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#生成-ssh-密钥对"}},[s._v("#")]),s._v(" 生成 ssh 密钥对")]),s._v(" "),n("p",[s._v("win10 和 win11 系统可以直接使用 powershell，Linux 和 Mac OS 也可以直接使用，其他系统请自行想办法解决。")]),s._v(" "),n("p",[s._v("使用以下命令生成密钥对"),n("sup",{staticClass:"footnote-ref"},[n("a",{attrs:{href:"#fn1",id:"fnref1"}},[s._v("[1]")])])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("ssh-keygen -t ed25519 -C "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"youer@mail.com"')]),s._v(" -f ./key.txt\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("其中参数有：")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("-C")]),s._v("  : 注释")]),s._v(" "),n("li",[n("code",[s._v("-f")]),s._v("  : 文件")])]),s._v(" "),n("p",[s._v("然后会让你输入密码，我们不需要密码，直接按回车即可。")]),s._v(" "),n("p",[s._v("然后就可以在你打开 powershell 的地方找到  "),n("code",[s._v("key.txt")]),s._v("  和  "),n("code",[s._v("key.txt.pub")]),s._v("  两个文件，将  "),n("code",[s._v("key.txt.pub")]),s._v("  重命名为  "),n("code",[s._v("key.txt.pub.txt")]),s._v(" ，方便打开。")]),s._v(" "),n("h2",{attrs:{id:"为仓库添加公钥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为仓库添加公钥"}},[s._v("#")]),s._v(" 为仓库添加公钥")]),s._v(" "),n("p",[s._v("打开 GitHub 仓库的  "),n("code",[s._v("Settings")]),s._v("  -  "),n("code",[s._v("Deploy keys")]),s._v(" ，添加公钥，内容就是前面生成的  "),n("code",[s._v("key.txt.pub.txt")]),s._v("  的内容。下面的  "),n("code",[s._v("Allow write access")]),s._v("  一定要勾选"),n("sup",{staticClass:"footnote-ref"},[n("a",{attrs:{href:"#fn2",id:"fnref2"}},[s._v("[2]")])]),s._v("。")]),s._v(" "),n("p",[s._v("注意是仓库的设置，不是账户的设置。")]),s._v(" "),n("p",[n("img",{attrs:{src:a(533),alt:"添加公钥"}})]),s._v(" "),n("p",[n("img",{attrs:{src:a(534),alt:"添加公钥"}})]),s._v(" "),n("h2",{attrs:{id:"添加私钥到-actions-secrets"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加私钥到-actions-secrets"}},[s._v("#")]),s._v(" 添加私钥到 Actions Secrets")]),s._v(" "),n("p",[s._v("打开 GitHub 仓库的  "),n("code",[s._v("Settings")]),s._v("  -  "),n("code",[s._v("Secrets")]),s._v("  -  "),n("code",[s._v("Actions")]),s._v(" ，添加  "),n("code",[s._v("repository secrets")]),s._v(" ，内容就是前面生成的  "),n("code",[s._v("key.txt")]),s._v("  的内容"),n("sup",{staticClass:"footnote-ref"},[n("a",{attrs:{href:"#fn3",id:"fnref3"}},[s._v("[3]")])]),s._v("。")]),s._v(" "),n("p",[s._v("注意 Name 要和  "),n("code",[s._v("CI")]),s._v("  中的变量对应。")]),s._v(" "),n("p",[n("img",{attrs:{src:a(535),alt:"添加私钥"}}),n("br"),s._v(" "),n("img",{attrs:{src:a(536),alt:"添加私钥"}})]),s._v(" "),n("h2",{attrs:{id:"编辑-ci-文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#编辑-ci-文件"}},[s._v("#")]),s._v(" 编辑 CI 文件")]),s._v(" "),n("div",{staticClass:"language-yml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# .github/workflows/deploy.yml")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" deploy\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在main分支发生push事件时触发。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("branches")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" main\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置环境变量")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("TZ")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Asia/Shanghai "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 时区（设置时区可使页面中的`最近更新时间`使用时区时间）")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jobs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("runs-on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ubuntu"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("latest "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行在虚拟机环境ubuntu-latest")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("steps")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检出")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Checkout\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" actions/checkout@v2\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装 node")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Setup Node\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" actions/setup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("node@v3\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("node-version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"16.x"')]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("registry-url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://registry.npmjs.org"')]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cache")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yarn"')]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Build\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token scalar string"}},[s._v("\n          yarn install\n          yarn build")]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发布到 gh-page 分支")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deploy github\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uses")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" peaceiris/actions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("gh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pages@v3\n        "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("with")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("publish_dir")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./dist\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("deploy_key")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" secrets.ACTIONS_DEPLOY_KEY "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("user_name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github-actions[bot]"')]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("user_email")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github-actions[bot]@users.noreply.github.com"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br")])]),n("h2",{attrs:{id:"测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[s._v("#")]),s._v(" 测试")]),s._v(" "),n("p",[s._v("推送到 GitHub 测试。")]),s._v(" "),n("h2",{attrs:{id:"注意事项"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[s._v("#")]),s._v(" 注意事项")]),s._v(" "),n("p",[s._v("生成的密钥对文件，一定要销毁，不要保存，这东西存着非但没用，反而是隐患。")]),s._v(" "),n("h2",{attrs:{id:"参考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),n("hr",{staticClass:"footnotes-sep"}),s._v(" "),n("section",{staticClass:"footnotes"},[n("ol",{staticClass:"footnotes-list"},[n("li",{staticClass:"footnote-item",attrs:{id:"fn1"}},[n("p",[n("a",{attrs:{href:"https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent",target:"_blank",rel:"noopener noreferrer"}},[s._v("Generating a new SSH key and adding it to the ssh-agent"),n("OutboundLink")],1),s._v(" "),n("a",{staticClass:"footnote-backref",attrs:{href:"#fnref1"}},[s._v("↩︎")])])]),s._v(" "),n("li",{staticClass:"footnote-item",attrs:{id:"fn2"}},[n("p",[n("a",{attrs:{href:"https://docs.github.com/en/developers/overview/managing-deploy-keys#deploy-keys",target:"_blank",rel:"noopener noreferrer"}},[s._v("Managing deploy keys"),n("OutboundLink")],1),s._v(" "),n("a",{staticClass:"footnote-backref",attrs:{href:"#fnref2"}},[s._v("↩︎")])])]),s._v(" "),n("li",{staticClass:"footnote-item",attrs:{id:"fn3"}},[n("p",[n("a",{attrs:{href:"https://docs.github.com/en/actions/security-guides/encrypted-secrets",target:"_blank",rel:"noopener noreferrer"}},[s._v("Encrypted secrets"),n("OutboundLink")],1),s._v(" "),n("a",{staticClass:"footnote-backref",attrs:{href:"#fnref3"}},[s._v("↩︎")])])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);